#  Authors:
#    Michael Mehl (mehl@dfki.de)
# 
#  Contributors:
#    optional, Contributor's name (Contributor's email address)
# 
#  Copyright:
#    Michael Mehl (mehl@dfki.de)
# 
#  Last change:
#    $Date$ by $Author$
#    $Revision$
# 
#  This file is part of Mozart, an implementation 
#  of Oz 3:
#     $MOZARTURL$
# 
#  See the file "LICENSE" or
#     $LICENSEURL$
#  for information on usage and redistribution 
#  of this file, and for a DISCLAIMER OF ALL 
#  WARRANTIES.


srcdir		= @srcdir@
VPATH		= @srcdir@
FSDIR		= @srcdir@
FDINCS		= -I.. -I$(srcdir)/..
CFLAGS		= $(COPT) $(DEFS) $(INCS) $(FDINCS) $(CWARN) $(CUSR)
CXXFLAGS	= $(CFLAGS)
DEPEND		= @DEPEND@ $(DEFS) $(INCS) $(FDINCS)
TARGETS		= libfset.a

FSETLIBSRCS =	$(FSDIR)/standard.cc $(FSDIR)/telling.cc \
		$(FSDIR)/testing.cc $(FSDIR)/fsaux.cc \
		$(FSDIR)/intsets.cc $(FSDIR)/monitor.cc \
		$(FSDIR)/reified.cc $(FSDIR)/fsstd.cc \
		$(FSDIR)/std_n.cc

FSETLIBOBJS = $(FSETLIBSRCS:.cc=.o)

all: $(TARGETS)

fsetlib.so: $(FSETLIBOBJS)
	$(DYNLD) -o $@ $(FSETLIBOBJS)

libfset.a: $(FSETLIBOBJS)
	$(AR) -rc $@ $(FSETLIBOBJS)
	$(RANLIB) $@

install-bin:
	$(INSTALL_BIN) $(TARGETS) $(bindir)

depend: $(FSETLIBSRCS) 
	$(DEPEND) $(FSETLIBSRCS) >> Makefile

tags:
	etags --regex='/OZ_C[^(]+([ 	]*\([^ 	,)]+\)/\1/' -l c++ \
	*c *h */*c */*h

clean:
	$(RM) *.o *~  *.bak *.obj

realclean: clean
	$(RM) *.a *.so Makefile

veryclean: realclean

.SUFFIXES: .cc .m4cc .hh .m4hh .s .E .sed

.cc.s:
	$(CXX) $(CXXFLAGS) -S -o $@ $<

.cc.E:
	$(CXX) $(CXXFLAGS) -E -o $@ $<
