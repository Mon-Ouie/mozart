TOOL		= gdbm

DYNLD		= @DYNLD@
CXX		= @CXX@
CPPFLAGS	= -I../../Emulator @CPPFLAGS@
CXXFLAGS	= $(CFLAGS)
LDFLAGS		= @LDFLAGS@
LIBS		= @LIBS@
OZBATCH		= @OZBATCH@

INSTALL		= @INSTALL@
INSTALL_DIR	= $(INSTALL) -m 775 -d
INSTALL_BIN	= $(INSTALL) -m 555
INSTALL_LIB	= $(INSTALL) -m 444

prefix		= @prefix@
bindir		= $(prefix)/platform/@platform@/tools/$(TOOL)
libdir		= $(prefix)/tools/$(TOOL)

all: gdbm.so gdbm.ozc

install:
	$(INSTALL_DIR) $(bindir)
	$(INSTALL_BIN) gdbm.so  $(bindir)
	$(INSTALL_DIR) $(libdir)
	$(INSTALL_LIB) gdbm.ozc $(libdir)

clean:
	$(RM) *~ *.bak gdbm.o gdbm.so gdbm.ozc

gdbm.o: gdbm.cc
	$(CXX) $(CPPFLAGS) $(CXXFLAGS) -c $<

gdbm.so: gdbm.o
	$(DYNLD) -o gdbm.so gdbm.o $(LDFLAGS) $(LIBS)

gdbm.ozc: gdbm.oz
	$(OZBATCH) -c gdbm.oz
