BINDIR  = $(OZHOME)/bin
SHELL   = /bin/sh
VCBIN=/MSDEV/BIN
SCRIPTS = oz oz+ ozplatform ozwish
LINKS   = oz- ozc ozsa ozsac oz.compiler oz.emulator ozdo \
          ozemacs ozdemo

.SUFFIXES: .cpp .res .rc .obj

all::
	@echo ""
	@echo "The following targets are available"
	@echo "	install		{scheidhr,mehl}@dfki.uni-sb.de"
	@echo ""

install:: $(BINDIR)
	install -m 555 $(SCRIPTS) $(BINDIR)
	@set -x; cd $(BINDIR);\
	for file in $(LINKS); \
        do\
	   rm -f $$file; \
	   ln -s oz $$file; \
        done

.cpp.obj:
	$(VCBIN)/cl -c $<

.rc.res:
	$(VCBIN)/rc $<

setup.exe: setup.obj setup.res
	$(VCBIN)/cl -o $@ setup.obj setup.res user32.lib advapi32.lib

oz.exe: oz.obj oz.res
	$(VCBIN)/cl -o $@ oz.obj oz.res user32.lib advapi32.lib

ozdemo.exe: ozdemo.obj oz.res
	$(VCBIN)/cl -o $@ ozdemo.obj oz.res user32.lib advapi32.lib

win-install:: setup.exe oz.exe ozdemo.exe
	cp setup.exe oz.exe ozdemo.exe $(OZHOME)

