#  Authors:
#    Michael Mehl (mehl@dfki.de)
# 
#  Contributors:
#    optional, Contributor's name (Contributor's email address)
# 
#  Copyright:
#    Michael Mehl (mehl@dfki.de)
# 
#  Last change:
#    $Date$ by $Author$
#    $Revision$
# 
#  This file is part of Mozart, an implementation 
#  of Oz 3:
#     $MOZARTURL$
# 
#  See the file "LICENSE" or
#     $LICENSEURL$
#  for information on usage and redistribution 
#  of this file, and for a DISCLAIMER OF ALL 
#  WARRANTIES.

PREFIX		= @prefix@
SRCDIR		= @srcdir@
BINDIR		= $(PREFIX)/bin
RM		= @RM@ -f
LN_S		= @LN_S@
INSTALL		= @INSTALL@
MKINSTALLDIRS	= @MKINSTALLDIRS@
INSTALL_BIN	= $(INSTALL) -m 555

SCRIPTS = oz ozplatform oz.wish ozdynld
LINKS   = oz- ozc ozsa ozcs ozsac oz.compiler oz.emulator ozdo \
          ozemacs ozdemo oze oznc ozapplet

.PHONY: all install clean distclean win-install

all:

install: $(BINDIR)
	$(INSTALL_BIN) $(SCRIPTS:%=$(SRCDIR)/%) $(BINDIR)
	@set -x; cd $(BINDIR);\
	for file in $(LINKS); \
        do\
	   $(RM) $$file; \
	   $(LN_S) oz $$file; \
        done

$(BINDIR):
	$(MKINSTALLDIRS) $@

ozdemo.exe: oz.exe
	cp oz.exe ozdemo.exe

win-install: setup.exe oz.exe ozdemo.exe ozsaw.exe ozsa.exe ozsac.exe
	$(INSTALL_BIN) setup.exe oz.exe ozdemo.exe $(PREFIX)
	$(INSTALL_BIN) ozsaw.exe ozsa.exe ozsac.exe \
		$(PREFIX)/platform/win32-i486

clean:
	$(RM) *.exe *.sym *.map *.mk* *.lk* *.err oz.res setup.res ozdemo.cpp

distclean: clean
	$(RM) Makefile config.cache config.log config.status
