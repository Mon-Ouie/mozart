####################################################

# Test for spaces
SPACELOCAL = \
        basic nomosim queens
SPACEOZC = $(SPACELOCAL:%=./space/%.ozc)

# Tests for finite domains
FDLOCAL = \
        distribute \
        alpha

FDOZC = $(FDLOCAL:%=./fd/%.ozc)

# Tests for scheduling
SCHEDLOCAL = \
        abz6
SCHEDOZC = $(SCHEDLOCAL:%=./scheduling/%.ozc)

# Other tests
OTHER = \
        link
OTHEROZC = $(OTHER:%=./%.ozc)


# All tests
COMPONENTS = \
        $(SPACEOZC) $(FDOZC) $(SCHEDOZC) $(OTHEROZC)


####################################################

RM      = @RM@ -f
OZBATCH = @OZBATCH@

OZE = $(OZBATCH)
OZC = $(OZBATCH) -c

all: test $(COMPONENTS)


make-test: ./lib/make-test.oz ./lib/engine.oz ./lib/passed.oz ./lib/failed.oz
        $(OZE) -l AP,SP ./lib/make-test.oz


test: $(COMPONENTS) make-test
        ./make-test -verbose $(COMPONENTS)


clean:
        $(RM) *~ ./*/*~ ./*/*/*~
        $(RM) make-test

veryclean: clean
        $(RM) $(COMPONENTS)
        $(RM) test

distclean: veryclean
        $(RM) config.cache config.log config.status
        $(RM) Makefile

.SUFFIXES: $SUFFIXES .ozc .oz

.oz.ozc:
        $(OZC) $< -o $@
