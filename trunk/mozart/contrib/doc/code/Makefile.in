@SET_MAKE@
BUILDTOP	= @BUILDTOP@
SRCTOP		= @SRCTOP@
SRCDIR		= @srcdir@
VPATH		= @srcdir@
PREFIX		= @prefix@
LIB_DIR		= $(PREFIX)/contrib/doc/code
ELIB_DIR	= $(PREFIX)/share/elisp
OZC		= @OZC@
INSTALL		= @INSTALL@
INSTALL_DIR	= @INSTALL_DIR@
INSTALL_LIB	= $(INSTALL) -m 444
EMACS		= emacs
HOMEURL         = @HOMEURL@

TARGETS		= Fontifier.ozf
ETARGETS	= Fontifier.elc
LIB_TARGETS	= $(addprefix $(LIB_DIR)/,$(TARGETS))
ELIB_TARGETS	= $(addprefix $(ELIB_DIR)/,$(ETARGETS))

all:		$(TARGETS) $(ETARGETS)
install:	$(LIB_DIR) $(LIB_TARGETS) $(ELIB_DIR) $(ELIB_TARGETS)

$(LIB_DIR) $(ELIB_DIR):
	$(INSTALL_DIR) $@

$(LIB_TARGETS): $(LIB_DIR)/% : %
	$(INSTALL_LIB) $< $@

$(ELIB_TARGETS): $(ELIB_DIR)/% : %
	$(INSTALL_LIB) $< $@

%.ozf: %.oz
	$(OZC) -z 9 -c $< -o $@

%.elc: %.el
	$(EMACS) -q -batch -f batch-byte-compile $<

%.el: %.EL
	@cp -f $< $@

clean veryclean:
	-rm *~ *.ozf *.elc

distclean: veryclean
	-rm Makefile config.*

include $(SRCDIR)/../../../share/Makefile.boot

bootstrap: boot-all

#---------------------------------------------------------------------
# Automatic Makefile update
#---------------------------------------------------------------------

Makefile: Makefile.in ../config.status
	cd .. && ./config.status

config.status: ../configure
	cd .. && ./config.status --recheck
