
To add an item to a tag, the option \?tags? is used
when creating the item. For instance,
\begin{ozdisplay}
@D@declare
@D@T = {New Tk.toplevel tkInit}
@D@C = {New Tk.canvas tkInit(parent:T)}
@D@{Tk.send pack(C)}
R = {New Tk.canvasTag tkInit(parent:C)}
{C tk(crea rectangle 10 10 40 40 fill:red tags:R)}
\end{ozdisplay}
creates a new rectangle item and adds it to the tag \?R?. 

A second oval item can be added to the tag \?R? by
\begin{ozdisplay}
{C tk(crea oval 20 20 40 40 tags:R)}
\end{ozdisplay}
All items refered to by a tag can be
manipulated simultanously. The following example moves all items 40 pixels
to the right:
\begin{ozdisplay}
{R tk(move 40 0)}
\end{ozdisplay}



\begin{maxifigure}
\DumpCode{\CDumpFile{tags.eps}}{%
\begin{ozdisplay}
@D@declare
@D@T = {New Tk.toplevel tkInit}
C = {New Tk.canvas tkInit(parent:T width:300 height:100)}
R = {New Tk.canvasTag tkInit(parent:C)}
O = {New Tk.canvasTag tkInit(parent:C)}
{C tkBind(event:'<1>' args:[int(x) int(y)]
          action: proc {$ X Y}
                     {C tk(crea rectangle X-10 Y-10 X+10 Y+10
                           tags:R fill:red)}
                  end)}
{C tkBind(event:'<2>' args:[int(x) int(y)]
          action: proc {$ X Y}
                     {C tk(crea oval X-20 Y-20 X+20 Y+20
                           tags:O fill:yellow)}
                  end)}
{Tk.send pack(C)}
\end{ozdisplay}
}
\caption{A canvas for creating rectangles and ovals.}
\label{fig:widgets-1:tags}
\end{maxifigure}

Figure~\ref{fig:widgets-1:tags} shows a small program that creates items
interactively. Pressing the mouse button over the canvas widget creates
either a rectangle item or an oval item at the position of the mouse
pointer. All rectangle items created are added to the tag \?R?, and all
oval items are added to the tag \?O?

Items can be configured by using the command \?itemconfigure?, which is
similar to the command \?configure? for widgets. The color of all
rectangle and oval items can be changed by:
\begin{ozdisplay}
{R tk(itemconfigure fill:wheat)}
{O tk(itemconfigure fill:blue)}
\end{ozdisplay}

Besides of the \?move? command there are other
commands for manipulating items. For instance, executing the following
statement
\begin{ozdisplay}
{O tk(delete)}
\end{ozdisplay}
deletes all oval items attached to the tag \?O?. Other commands allow to
scale items, to change the coordinates of items and so on. More
information on possible commands are available from the manpage
\manpage{n}{canvas}.

\subsection{Event Bindings}

Similar to widgets, event bindings can be created for tags. To create an
event binding for a tag means to create the event binding for all items
refered to by the tag. The following example creates an event binding
for all oval items. 
\begin{ozdisplay}
@D@declare
create Colors from UrObject
   attr cs:(Cs=red|green|blue|yellow|orange|Cs in Cs)
   meth get($)  cs<-@cs.2 @cs.1  end
end
{O tkBind(event:  '<3>' 
          action: O # tk(itemconfigure 
                         fill:{Colors get($)}))}
\end{ozdisplay}
Clicking with the right mouse button on an oval item, configures all
items refered to by \?O? to employ a different color. The \?Colors?
object serves as color generator. Each time the method \?get? is
invoked, it returns a color from the circular list of colors stored in
the attribute \?cs?.


\section{Animated Graphics}

\begin{maxifigure}
\DumpCode{\CDumpFile{animated.eps}}{%
\begin{ozdisplay}
@D@declare
fun {RandCoord}
   {Unix.rand} mod 20 + 15
end
class RandMag from Tk.canvasTag Time.repeat
   meth init(parent:P)
      RandMag,tkInit(parent:P)
      {P tk(crea bitmap 0 0 bitmap:'@'#{System.get home}#
	    '/demo/documentation/images/magnifier.xbm'
	   tags:self foreground:blue)}
      RandMag,setRepAll(delay:100 action:move)
             ,go
   end
   meth move
      RandMag,tk(coords {RandCoord} {RandCoord})
   end
end
proc {WaitSearch Kill Solution}
   T={New Tk.toplevel tkInit(title:'Searching...')}
   L={New Tk.label  tkInit(parent:T text:'Searching...')}
   C={New Tk.canvas tkInit(parent:T width:50 height:50)}
   B={New Tk.button tkInit(parent:T text:'Kill' action:Kill)}
in
   {Tk.send pack(L C B side:left pady:2#m padx:2#m)}
   _ = {New RandMag init(parent:C)}
   thread {Wait Solution} {T close} end
end
\end{ozdisplay}
}
\caption{An animated time waster.}
\label{fig:canvas-text:animated}
\end{maxifigure}


\section{Text Widgets}

\section{Text Tags and Text Marks}

\secmtion{Events and Actions}

