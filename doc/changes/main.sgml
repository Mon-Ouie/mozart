<!--
  - Authors:
  -   Christian Schulte <schulte@ps.uni-sb.de>
  -
  - Copyright:
  -   Christian Schulte, 1998
  -
  - Last change:
  -   $Date$ by $Author$
  -   $Revision$
  -
  - This file is part of Mozart, an implementation
  - of Oz 3
  -    http://mozart.ps.uni-sb.de
  -
  - See the file "LICENSE" or
  -    http://mozart.ps.uni-sb.de/LICENSE.html
  - for information on usage and redistribution
  - of this file, and for a DISCLAIMER OF ALL
  - WARRANTIES.
  -
  -->

<!DOCTYPE Book SYSTEM "ozdoc.dtd" [

<!-- Extension to the DTD -->
<!ENTITY % proglang.values.local "|sh|fundamental">

<!ENTITY % author.class "author|author.extern|comic">
<!ENTITY % picture.element "picture|picture.extern|picture.choice">
<!ELEMENT comic - O (%picture.element;)>

<!-- Include Files -->

<!-- Abbreviations -->
<!ENTITY lt "<">
<!ENTITY gt ">">
<!ENTITY dot "." -- to distinguish it from periods -->
<!ENTITY Oz "Oz">

<!-- Processing Instructions -->
<!ENTITY emdash PI "emdash">
<!ENTITY endash PI "endash">
<!ENTITY nbsp PI "nbsp">
<!ENTITY ellipsis PI "ellipsis">
<!ENTITY slash PI "slash">
<!ENTITY ie PI "ie">
<!ENTITY wrt PI "wrt">
<!ENTITY eg PI "eg">

]>

<Book proglang=oz>
  <Front>
    <meta name="proglang.mode" arg1="oz" arg2="oz-mode">

    <Meta name="html.split"       value="chapter.general">
    <Meta name="html.split"       value="chapter.syntax">
    <Meta name="html.split"       value="chapter.base">
    <Meta name="html.split"       value="chapter.system">
    <Meta name="html.split"       value="chapter.tools">

    <Meta name=ozversion value="3.0">
    <Meta name=status value=revised>
    <Title/Changes/
    <Abstract>
      This documents gives a brief overview of what has changed from
      Oz 2.0 (and its implementation DFKI Oz) to Oz 3.0 (and its
      implementation Mozart).
    </Abstract>
  <Body>
    <chapter id="chapter.general">
      <title/General Changes/

      <section id="section.general.modules">
        <title/Functors and Modules/

        <p>
          Mozart now comes with a powerful internet-based module
          system that supports lazy loading, native modules and
          more. For an introduction see <ptr.extern
          to="ozdoc:apptut">.

        <p>
          To make best use of the new module system, the previous Oz
          Standard Modules have been split into the <em/base
          environment/ and the <em/system modules/. The compiler
          always provides the base environment, it contains all
          operations working on data structures like records, lists,
          and so on. For more information see <ptr.extern
          to="ozdoc:base">.

        <p>
          All remaining modules (including the constraint programming
          support) are now provided as system modules that are subject
          to import in functor definitions. The system modules are
          described in <ptr.extern to="ozdoc:system">.

        <p>
          The Oz Programming Environment however still follows the
          design to ease explorative development. For that reason all
          system modules are still available in the Oz Programming
          Environment. The Environment nicely exemplifies the merits
          of the new module system: while providing all system modules
          the Environment starts in a fraction of a second by taking
          advantage of dynamic linking.

      <section id="section.general.app">
        <title/Applications/

        <p>
          The rudimentary standalone application support available in
          DFKI Oz has been replaced by powerful abstractions and
          command line tools (see <ptr.extern to="ozdoc:tools">) to
          support different aspects of application programming. In
          fact, a new tutorial (see <ptr.extern to="ozdoc:apptut">)
          is entirely devoted to application programming with Oz and
          Mozart.

    <Chapter id="chapter.syntax" proglang=oz>
      <Title/Syntax Improvements/
      <P>
        Mozart implements the language Oz&nbsp;3, as opposed to
        DFKI Oz&nbsp;2, which implemented Oz&nbsp;2.  This chapter
        summarizes language changes between Oz&nbsp;2 and Oz&nbsp;3,
        of which most are only of syntactical nature.
      <Section>
        <Title/Conditionals/
        <P>
          The <<case>> keyword used to introduce one of two conditionals:
          the boolean or the pattern matching conditional.  To adapt to
          common intuitions, the syntax and semantics have been changed.
        <Para class=apropos><Title/Boolean Conditionals/
          The boolean conditional is now written as
          <<<if ?{E} then ?{SE1} else ?{SE2} end>>>
          If the construct is statement position, the <<else ?{SE2}>> part
          is optional and defaults to <<else skip>>.
        <P>
          Since the <<if>> keyword is now used for boolean conditionals,
          the former (and seldom used) <<if>> conditional has been renamed
          to <<cond>>.  There is no <<elsecond>> to replace <<elseif>>.
        <Para class=apropos><Title/Pattern-Matching/
          The <<case ?{E} of &ellipsis; end>> conditional retains its syntax
          but changes its semantics.  Where formerly logic (dis-)entailment
          was used to match the value against a pattern, now a series of
          sequential tests is performed.  This makes no difference if the
          match is entailed.  Disentailment, however, may remain undiscovered
          and the thread block, &eg;, in:
          <<<case f(a b) of f(X X) then &ellipsis; end>>>
        <P>
          Furthermore, the box <<[]>> separating pattern-matching clauses
          now also has sequential semantics, and is thus equivalent to the
          now deprecated, though still allowed, <<elseof>>.
        <P>
          <<elseif>> and <<elsecase>> may still be freely intermixed within
          <<if>> and <<case>> conditionals.
      <Section>
        <Title/Functors/
        <P>
          To accomodate modular application development, a module system
          has been designed.  The language itself supports the definition
          of <Em/functors/, from which modules can be obtained via linking.
      <Section>
        <Title/Exceptions/
        <P>
          The construct <<raise ?{E1} with ?{E2} end>> has been removed.
          This was an experimental feature that has been found to be
          rarely used.
      <Section>
        <Title/Keywords/
        <Para class=apropos><Title/New Keywords/
          Due to syntax changes, Oz&nbsp;3 has the following keywords, which
          thus cannot be used as unquoted atoms any more:
          <Table>
            <TR>
              <TD/<<at>>/<TD/<<cond>>/<TD/<<define>>/<TD/<<export>>/
            <TR>
              <TD/<<functor>>/<TD/<<import>>/<TD/<<prepare>>/<TD/<<require>>/
          </Table>
        <Para class=apropos><Title/Removed Keywords/
          The following keywords have been returned atom status and do
          not count as keywords any more:
          <Table>
            <TR>
              <TD/<<with>>/
          </Table>
      <Section>
        <Title/Core Expansion/
        <P>
          The core expansion of Oz&nbsp;3 as defined in
          <Ptr.Extern to="ozdoc:notation"> does not give core variables
          (written without backquotes) normal variable status any more,
          but considers them variables statically bound within a runtime
          library environment.  This means that the used backquote
          variables are not part of the Base Environment.
        <P>
          This was necessary because the old design compromised language
          security.

    <chapter id="chapter.base">
      <title/Base/
      <p>
        This chapter documents the changes that have taken place in the
        Base Environment (formerly Standard Modules) and base language.

      <section class=unumbered>
        <title/Classes with Multiple Inheritance/

        <p>
          Multiple inheritance does not provide for automatic
          conflict resolution. If a conflicting method definition
          arises in multiple inheritance, the
          conflict <em/must/ be resolved by overriding the
          method. Otherwise, an exception is raised.
        <p>
          A conflicting method definition arises if a method is
          defined by more than one class. For example,
<<<class A meth m skip end end
class B meth m skip end end
class C from A B end>>>
          raises an exception (the old model would silently pick the
          method from <<B>>), since both <<A>> and <<B>> define the
          method <<m>>. The only way to fix this is by overriding <<m>>
          when creating class <<C>>:
          <<<class C from A B meth m skip end end>>>
        <p>
          Features and attributes are handled identically. For a
          more thorough discussion see <ptr.extern
          to="ozdoc:tutorial" key="chapter.classes">.

      <section class=unumbered>
        <title/The Modules <<Class>> and <<Object>>/

        <p>
          The modules <<Class>> and <<Object>> underwent a major
          redesign and re-implementation. The redesign became
          necessary because the old modules compromised both system
          and application security. Programming abstractions that
          support common patterns of object oriented programming are
          described in the module <<ObjectSupport>> (see <ptr.extern
          to="ozdoc:system" key="chapter.objectsupport">).


      <section id="section.base.chunks">
        <title/Chunks/

        <p>
          The procedures <<Chunk.hasFeature>> and <<Chunk.getFeature>>
          are gone. Just use <<HasFeature>> and <<Value.'.'>> (see
          <ptr.extern to="ozdoc:base" key="chapter.values">).

    <chapter id="chapter.system">
      <title/System Modules/


      <section id="section.system.search">
        <title/Search Engines renamed/

        <p>
          The engines that used to be available by <<SearchOne>>,
          <<SearchAll>>, and <<SearchBest>> are now available under
          <<Search.base.one>>, <<Search.base.all>>, and
          <<Search.base.best>> (for more information see <ptr.extern
          to="ozdoc:system" key="chapter.search">). However in the Oz
          Programming Interface <<SearchOne>>,
          <<SearchAll>>, and <<SearchBest>> are still available for
          convenience.

      <section id="section.system.schedule">
        <title/Scheduling support moved/

        <p>
          Scheduling support is now provided by the system module
          <<Schedule>> rather than <<FD.schedule>>. See also
          <ptr.extern to="ozdoc:fdt" key="chapter.scheduling">  and
          <ptr.extern to="ozdoc:system" key="chapter.schedule">.

      <section id="section.system.property">
        <title/<<System.get>> and <<System.set>>/

        <p>
          <<System.get>> and <<System.set>> have been replaced by more
          powerful procedures that are available in the module
          <<Property>>, which is described in
          <ptr.extern to="ozdoc:system" key="chapter.property">.

      <section id="section.system.vstoval">
        <title/<<System.valueToVirtualString>> and <<System.virtualStringToValue>>/

        <p>
          <<System.valueToVirtualString>> and
          <<System.virtualStringToValue>> are now available as
<<Value.toVirtualString>> (see
          <ptr.extern to="ozdoc:base" key="chapter.values">) and
<<Compiler.virtualStringToValue>> (see
          <ptr.extern to="ozdoc:compiler"
          key="section.api.module">). In particular,
          <<Compiler.virtualStringToValue>> is a full featured and
          stable replacement for the ad-hoc
          <<System.virtualStringToValue>>.

    <Chapter id="chapter.tools">
      <Title/Tools/
      <Section>
        <Title/New Tools/
        <P>
          Mozart comes with (improved) versions of the tools that
          came with DFKI Oz.  Additionally, it has:
          <List>
            <Item>a profiler, described in <Ptr.Extern to="ozdoc:profiler">,
              and
            <Item>a source-level debugger called Ozcar, described in
              <Ptr.Extern to="ozdoc:ozcar">.
          </List>
      <Section>
        <Title/Compiler/
        <P>
          The compiler has been reimplemented in Oz.  This means that an
          arbitrary number of compiler objects may be instantiated on the
          same VM.  Linguistic reflection is thus fully supported through
          an API that offers unrestricted access to the compiler's
          functionality, documented in <Ptr.Extern to="ozdoc:compiler">.
      <Section>
        <Title/Gump/
        <P>
          Gump, the frontend generator for Oz, is no longer a stand-alone
          tool that must be invoked on a file, but is closely integrated
          into the Oz compiler.  It is now sufficient to set a switch:
          <<<\switch +gump>>>
          and full Gump functionality as described in <Ptr.Extern
          to="ozdoc:gump"> is available within the language.  Furthermore,
          support for Gump under Windows has been greatly improved.

</Book>
